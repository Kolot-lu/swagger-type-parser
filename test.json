{
  "openapi": "3.1.0",
  "info": { "title": "Modular CRM Backend", "version": "0.1.0" },
  "paths": {
    "/api/v1/health": {
      "get": {
        "tags": ["system"],
        "summary": "Health Check",
        "description": "Lightweight health endpoint for load balancers and uptime checks.\nDoes not touch the database to remain cheap.",
        "operationId": "health_check_api_v1_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HealthCheckResponse" }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/register": {
      "post": {
        "tags": ["auth"],
        "summary": "Register",
        "description": "Register a new platform user.\n\nProtected by rate limiting to prevent abuse:\n- 3 registrations per hour per IP address\n\nTokens are stored in HTTPOnly cookies for security.\nFor MVP we immediately issue access/refresh tokens after registration.\nEmail verification and consent flows will be added on top.\n\nArgs:\n    payload: Registration request with email, password, locale, and optional name.\n    request: FastAPI request object.\n    response: FastAPI response object for setting cookies.\n    db: Database session.\n\nReturns:\n    RegisterResponse with user data. Tokens are set in HTTPOnly cookies.\n\nRaises:\n    HTTPException: If registration fails (email exists, weak password, rate limit).",
        "operationId": "register_api_v1_auth_register_post",
        "requestBody": {
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/RegisterRequest" } }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/RegisterResponse" } }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/login": {
      "post": {
        "tags": ["auth"],
        "summary": "Login",
        "description": "Authenticate a user with email + password and obtain tokens.\n\nProtected by rate limiting and account lockout:\n- 5 login attempts per 15 minutes per email/IP\n- 10 login attempts per hour per email/IP\n- Account locked after 5 failed attempts (15 min) or 10 attempts (1 hour)\n\nTokens are stored in HTTPOnly cookies for security.\n\nArgs:\n    payload: Login request with email and password.\n    request: FastAPI request object.\n    response: FastAPI response object for setting cookies.\n    db: Database session.\n\nReturns:\n    LoginResponse with user data. Tokens are set in HTTPOnly cookies.\n\nRaises:\n    HTTPException: If credentials are invalid, account is locked, or rate limit exceeded.",
        "operationId": "login_api_v1_auth_login_post",
        "requestBody": {
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/LoginRequest" } }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/LoginResponse" } }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/verify-email": {
      "post": {
        "tags": ["auth"],
        "summary": "Verify Email",
        "description": "Verify a user's email address using a token from the verification email.\n\nAfter successful verification, the user's email_verified flag is set to True\nand their status is updated to ACTIVE if it was PENDING_EMAIL_VERIFICATION.\n\nArgs:\n    payload: Verification request with token.\n    db: Database session.\n\nReturns:\n    VerifyEmailResponse with success message.\n\nRaises:\n    HTTPException: If token is invalid, expired, or already used.",
        "operationId": "verify_email_api_v1_auth_verify_email_post",
        "requestBody": {
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/VerifyEmailRequest" } }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/VerifyEmailResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/request-password-reset": {
      "post": {
        "tags": ["auth"],
        "summary": "Request Password Reset",
        "description": "Request a password reset email.\n\nProtected by rate limiting:\n- 3 requests per hour per email address\n\nThis endpoint always returns success (even if the email doesn't exist)\nto prevent email enumeration attacks. If the email exists, a password\nreset token will be sent.\n\nArgs:\n    payload: Password reset request with email.\n    db: Database session.\n\nReturns:\n    RequestPasswordResetResponse with generic success message.\n\nRaises:\n    HTTPException: If rate limit is exceeded.",
        "operationId": "request_password_reset_api_v1_auth_request_password_reset_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/RequestPasswordResetRequest" }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/RequestPasswordResetResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/reset-password": {
      "post": {
        "tags": ["auth"],
        "summary": "Reset Password",
        "description": "Reset a user's password using a token from the password reset email.\n\nThe token is single-use and expires after a configured time period.\n\nArgs:\n    payload: Password reset request with token and new password.\n    db: Database session.\n\nReturns:\n    ResetPasswordResponse with success message.\n\nRaises:\n    HTTPException: If token is invalid, expired, already used, or password doesn't meet requirements.",
        "operationId": "reset_password_api_v1_auth_reset_password_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ResetPasswordRequest" }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ResetPasswordResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/resend-verification": {
      "post": {
        "tags": ["auth"],
        "summary": "Resend Verification Email",
        "description": "Resend email verification for the current authenticated user.\n\nThis revokes any existing unused verification tokens and sends a new\nverification email. Only works for users who haven't verified their email yet.\n\nArgs:\n    current_user: The authenticated user (from dependency).\n    db: Database session.\n\nReturns:\n    ResendVerificationEmailResponse with success message.\n\nRaises:\n    HTTPException: If user not found or already verified.",
        "operationId": "resend_verification_email_api_v1_auth_resend_verification_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ResendVerificationEmailResponse" }
              }
            }
          }
        },
        "security": [{ "OAuth2PasswordBearer": [] }]
      }
    },
    "/api/v1/auth/refresh": {
      "post": {
        "tags": ["auth"],
        "summary": "Refresh Token",
        "description": "Exchange a refresh token for new access and refresh tokens.\n\nThis implements token rotation: the old refresh token is revoked and a new\none is issued. This prevents token reuse attacks and allows detection of\ntoken theft.\n\nThe new tokens have the same expiration times as the original tokens.\nTokens are stored in HTTPOnly cookies for security and are never\nincluded in the response body.\n\nSecurity: Refresh token must be provided in HTTPOnly cookie only.\nThis prevents XSS attacks and token theft through JavaScript access.\n\nArgs:\n    request: FastAPI request object.\n    response: FastAPI response object for setting cookies.\n    db: Database session.\n\nReturns:\n    RefreshTokenResponse with user data. New tokens are set in HTTPOnly cookies.\n\nRaises:\n    HTTPException: If refresh token is missing, invalid, expired, or revoked.",
        "operationId": "refresh_token_api_v1_auth_refresh_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/RefreshTokenResponse" }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/logout": {
      "post": {
        "tags": ["auth"],
        "summary": "Logout",
        "description": "Logout by revoking the refresh token session.\n\nThis invalidates the refresh token, preventing further token refreshes.\nThe access token will naturally expire on its own (typically within 30 minutes).\n\nAfter logout, the user will need to log in again to obtain new tokens.\nCookies are cleared on logout.\n\nSecurity: Refresh token must be provided in HTTPOnly cookie only.\nThis prevents XSS attacks and token theft through JavaScript access.\n\nArgs:\n    request: FastAPI request object.\n    response: FastAPI response object for clearing cookies.\n    db: Database session.\n\nReturns:\n    LogoutResponse with success message.\n\nNote:\n    Cookies are cleared even if logout fails to ensure security.",
        "operationId": "logout_api_v1_auth_logout_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/LogoutResponse" } }
            }
          }
        }
      }
    },
    "/api/v1/auth/session-timeout-warning": {
      "get": {
        "tags": ["auth"],
        "summary": "Session Timeout Warning",
        "description": "Check if the current session is about to expire.\n\nThis endpoint helps the frontend show a warning to users before their\nsession expires, allowing them to extend their session if needed.\n\nArgs:\n    request: FastAPI request object.\n    current_user: The authenticated user (from dependency).\n\nReturns:\n    Dictionary with:\n    - expires_in_seconds: Time until session expires (in seconds)\n    - should_warn: Boolean indicating if warning should be shown\n    - warning_threshold_seconds: Threshold for showing warning (default: 5 minutes)",
        "operationId": "session_timeout_warning_api_v1_auth_session_timeout_warning_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Session Timeout Warning Api V1 Auth Session Timeout Warning Get"
                }
              }
            }
          }
        },
        "security": [{ "OAuth2PasswordBearer": [] }]
      }
    },
    "/api/v1/auth/me": {
      "get": {
        "tags": ["auth"],
        "summary": "Get Me",
        "description": "Return the current authenticated user with permissions and roles.\n\nThis endpoint is called frequently by UIs to:\n- Check authentication status\n- Determine what UI elements to show/hide based on permissions and roles\n- Identify platform owners and managers (via is_owner flag in roles)\n- Refresh user data after permission/role changes\n\nPermissions and roles are included to enable client-side authorization checks.\nNote: Company-scoped permissions and roles require tenant context and are not included here.\n\nArgs:\n    current_user: The authenticated user (from dependency).\n    db: Database session.\n\nReturns:\n    UserOut schema with user data, profile, permissions, and roles.",
        "operationId": "get_me_api_v1_auth_me_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/UserOut" } }
            }
          }
        },
        "security": [{ "OAuth2PasswordBearer": [] }]
      }
    },
    "/api/v1/companies": {
      "get": {
        "tags": ["companies"],
        "summary": "List My Companies",
        "description": "List all companies where the current user is a member.",
        "operationId": "list_my_companies_api_v1_companies_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/CompanyListResponse" }
              }
            }
          }
        },
        "security": [{ "OAuth2PasswordBearer": [] }]
      },
      "post": {
        "tags": ["companies"],
        "summary": "Create Company",
        "description": "Create a new company and assign current user as its owner.\n\nLater we will integrate plan selection and billing here.",
        "operationId": "create_company_api_v1_companies_post",
        "requestBody": {
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/CompanyCreate" } }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/CompanyCreateResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        },
        "security": [{ "OAuth2PasswordBearer": [] }]
      }
    },
    "/api/v1/companies/{company_id}": {
      "get": {
        "tags": ["companies"],
        "summary": "Get Company",
        "description": "Get company by id.\n\nAccess is allowed for:\n- any member of the company;\n- platform owners (regardless of membership).\nThe `get_tenant_context` dependency enforces these rules.",
        "operationId": "get_company_api_v1_companies__company_id__get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "company_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "Company Id" }
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/CompanyOut" } }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/billing/plans": {
      "get": {
        "tags": ["billing"],
        "summary": "List Plans",
        "description": "List all available subscription plans.",
        "operationId": "list_plans_api_v1_billing_plans_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/PlanListResponse" } }
            }
          }
        }
      }
    },
    "/api/v1/billing/modules": {
      "get": {
        "tags": ["billing"],
        "summary": "List Modules",
        "description": "List all registered modules (crm, hr, billing, etc.).",
        "operationId": "list_modules_api_v1_billing_modules_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ModuleListResponse" }
              }
            }
          }
        }
      }
    },
    "/api/v1/devices/devices": {
      "get": {
        "tags": ["devices"],
        "summary": "List Devices",
        "description": "List all devices for the current authenticated user.\n\nReturns a list of devices associated with the user's account,\nincluding device information, status, and last seen timestamp.\n\nArgs:\n    current_user: The authenticated user (from dependency).\n    db: Database session.\n    include_revoked: Whether to include revoked devices in the response.\n\nReturns:\n    DeviceListResponse with list of user's devices.",
        "operationId": "list_devices_api_v1_devices_devices_get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "include_revoked",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "description": "Include revoked devices",
              "default": false,
              "title": "Include Revoked"
            },
            "description": "Include revoked devices"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DeviceListResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/devices/devices/{device_id}": {
      "delete": {
        "tags": ["devices"],
        "summary": "Revoke Device",
        "description": "Revoke a device and all its associated sessions.\n\nThis will:\n- Mark the device as revoked\n- Revoke all active sessions for this device\n- Force logout from this device\n\nUsers can only revoke their own devices.\n\nArgs:\n    device_id: UUID of the device to revoke.\n    request: FastAPI request object.\n    current_user: The authenticated user (from dependency).\n    db: Database session.\n\nReturns:\n    DeviceRevokeResponse with success message.\n\nRaises:\n    HTTPException: If device not found or user doesn't own the device.",
        "operationId": "revoke_device_api_v1_devices_devices__device_id__delete",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "device_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "Device Id" }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DeviceRevokeResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/dynamic-fields/definitions": {
      "get": {
        "tags": ["dynamic-fields"],
        "summary": "List Definitions",
        "description": "List dynamic field definitions.\n\nFor now we filter only by entity_type; later we will add tenant/user-aware\nresolution and RBAC.",
        "operationId": "list_definitions_api_v1_dynamic_fields_definitions_get",
        "parameters": [
          {
            "name": "entity_type",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "Entity Type"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DynamicFieldDefinitionListResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["dynamic-fields"],
        "summary": "Create Definition",
        "description": "Create a new dynamic field definition.\n\nThis is the endpoint that will be used for:\n- platform/company admins defining fields for user_profile;\n- users defining self-managed fields (scope=per_user, owner_user_id=current_user.id);\n- company owners defining per-company user fields (scope=per_company, company_id=...).",
        "operationId": "create_definition_api_v1_dynamic_fields_definitions_post",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/DynamicFieldDefinitionCreate" }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DynamicFieldDefinitionOut" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/dynamic-fields/definitions/{definition_id}": {
      "patch": {
        "tags": ["dynamic-fields"],
        "summary": "Update Definition",
        "description": "Update an existing field definition.\n\nTODO: enforce that only allowed admins/owners can update.",
        "operationId": "update_definition_api_v1_dynamic_fields_definitions__definition_id__patch",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "definition_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "Definition Id" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/DynamicFieldDefinitionUpdate" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DynamicFieldDefinitionOut" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/dynamic-fields/entities/{entity_type}/{entity_id}": {
      "get": {
        "tags": ["dynamic-fields"],
        "summary": "Get Entity Values",
        "description": "Get all dynamic field values for a single entity instance.\n\nFor user profile:\n- entity_type=\"user_profile\", entity_id=current_user.id (or profile id),\n  possibly combined with company_id for company-local fields.",
        "operationId": "get_entity_values_api_v1_dynamic_fields_entities__entity_type___entity_id__get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "entity_type",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "title": "Entity Type" }
          },
          {
            "name": "entity_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "Entity Id" }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DynamicFieldValuesResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["dynamic-fields"],
        "summary": "Set Entity Values",
        "description": "Upsert dynamic field values for a single entity instance.\n\nFor user profile:\n- entity_type=\"user_profile_self\": user updating own self-managed fields;\n- entity_type=\"user_profile_company\": company owner/admin updating company-local fields;\n- entity_type=\"user_profile\": platform/company admin updating global fields.",
        "operationId": "set_entity_values_api_v1_dynamic_fields_entities__entity_type___entity_id__put",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "entity_type",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "title": "Entity Type" }
          },
          {
            "name": "entity_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "Entity Id" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/DynamicFieldValuesUpdateRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DynamicFieldValuesResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/rbac/permissions": {
      "get": {
        "tags": ["rbac"],
        "summary": "List Permissions",
        "description": "List all registered permissions.\n\nIn the future this endpoint will be restricted to platform administrators\nwith the appropriate RBAC permission (e.g. `platform.rbac.manage`).",
        "operationId": "list_permissions_api_v1_rbac_permissions_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/PermissionListResponse" }
              }
            }
          }
        },
        "security": [{ "OAuth2PasswordBearer": [] }]
      }
    },
    "/api/v1/rbac/roles/platform": {
      "get": {
        "tags": ["rbac"],
        "summary": "List Platform Roles",
        "description": "List platform-scoped roles.\n\nThis is primarily useful for admin panels and debugging RBAC configuration.",
        "operationId": "list_platform_roles_api_v1_rbac_roles_platform_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/RoleListResponse" } }
            }
          }
        },
        "security": [{ "OAuth2PasswordBearer": [] }]
      }
    },
    "/api/v1/users/me": {
      "get": {
        "tags": ["users"],
        "summary": "Get Me",
        "description": "Get current authenticated user with complete information.\n\nReturns comprehensive user data including:\n- User account information (email, status, locale, etc.)\n- Profile data (first_name, last_name, avatar, etc.)\n- Platform permissions (via platform roles)\n- Platform roles\n- Dynamic field values (scoped by platform/company/user)\n- Ban information (if applicable)\n\nThis endpoint is similar to /auth/me but includes dynamic fields support\nand is part of the users module for better organization.\n\nArgs:\n    current_user: Currently authenticated user.\n    tenant: Optional tenant context for company-scoped fields.\n    db: Database session.\n    include_permissions: Whether to include permissions (default: True).\n    include_roles: Whether to include roles (default: True).\n    include_dynamic_fields: Whether to include dynamic fields (default: True).\n\nReturns:\n    UserResponse with complete user information.",
        "operationId": "get_me_api_v1_users_me_get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "include_permissions",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "description": "Include user permissions in response",
              "default": true,
              "title": "Include Permissions"
            },
            "description": "Include user permissions in response"
          },
          {
            "name": "include_roles",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "description": "Include user roles in response",
              "default": true,
              "title": "Include Roles"
            },
            "description": "Include user roles in response"
          },
          {
            "name": "include_dynamic_fields",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "description": "Include dynamic field values in response",
              "default": true,
              "title": "Include Dynamic Fields"
            },
            "description": "Include dynamic field values in response"
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/UserResponse" } }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/users": {
      "get": {
        "tags": ["users"],
        "summary": "List Users",
        "description": "List users with access control and GDPR compliance.\n\nAccess rules:\n- Company owners: Can see all users in their company (full information)\n  Requires X-Company-Id header.\n- Platform owners: Can see all users in system (minimal information for GDPR)\n- Regular users: Cannot list other users\n\nFor GDPR compliance, platform owners receive minimal user data:\n- Only essential fields (id, email, status, email_verified, created_at)\n- Profile data (if exists)\n- No ban information, no permissions, no roles\n\nCompany owners receive full information for users in their company:\n- All user fields including ban information\n- Full profile data\n- This is allowed as company owners have legitimate interest in managing\n  their company members.\n\nArgs:\n    current_user: Currently authenticated user.\n    tenant: Optional tenant context (required for company owners).\n    db: Database session.\n    page: Page number (1-based, default: 1).\n    per_page: Number of items per page (default: 50, max: 100).\n    status: Optional filter by user status.\n\nReturns:\n    UserListResponse with paginated list of users.\n\nRaises:\n    HTTPException: If access denied or tenant context required.",
        "operationId": "list_users_api_v1_users_get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "description": "Page number (1-based)",
              "default": 1,
              "title": "Page"
            },
            "description": "Page number (1-based)"
          },
          {
            "name": "per_page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Number of items per page",
              "default": 50,
              "title": "Per Page"
            },
            "description": "Number of items per page"
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "description": "Filter by user status (active, blocked, etc.)",
              "title": "Status"
            },
            "description": "Filter by user status (active, blocked, etc.)"
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/UserListResponse" } }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/{user_id}": {
      "get": {
        "tags": ["users"],
        "summary": "Get User",
        "description": "Get user information by ID.\n\nAccess rules:\n- Users can always access their own information\n- Platform owners can access any user's information\n- Company owners can access information of users in their company\n\nArgs:\n    user_id: ID of user whose information to retrieve.\n    current_user: Currently authenticated user.\n    tenant: Optional tenant context.\n    db: Database session.\n    include_permissions: Whether to include permissions (default: False for other users).\n    include_roles: Whether to include roles (default: False for other users).\n    include_dynamic_fields: Whether to include dynamic fields (default: True).\n\nReturns:\n    UserResponse with user information.\n\nRaises:\n    HTTPException: If user not found or access denied.",
        "operationId": "get_user_api_v1_users__user_id__get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "User Id" }
          },
          {
            "name": "include_permissions",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "description": "Include user permissions in response",
              "default": false,
              "title": "Include Permissions"
            },
            "description": "Include user permissions in response"
          },
          {
            "name": "include_roles",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "description": "Include user roles in response",
              "default": false,
              "title": "Include Roles"
            },
            "description": "Include user roles in response"
          },
          {
            "name": "include_dynamic_fields",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "description": "Include dynamic field values in response",
              "default": true,
              "title": "Include Dynamic Fields"
            },
            "description": "Include dynamic field values in response"
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/UserResponse" } }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/profile": {
      "get": {
        "tags": ["users"],
        "summary": "Get Profile",
        "description": "Get current user's profile with dynamic fields.\n\nReturns profile data including:\n- Standard profile fields (first_name, last_name, etc.)\n- Dynamic field values (scoped by platform/company/user)\n\nArgs:\n    current_user: Currently authenticated user.\n    tenant: Optional tenant context for company-scoped fields.\n    db: Database session.\n\nReturns:\n    ProfileResponse with profile data and dynamic fields.",
        "operationId": "get_profile_api_v1_users_profile_get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ProfileResponse" } }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      },
      "patch": {
        "tags": ["users"],
        "summary": "Update Profile",
        "description": "Update current user's profile.\n\nOnly the profile owner can update their profile. Platform owners\nand company owners can also update profiles of users in their scope.\n\nArgs:\n    payload: Profile update data (partial update).\n    current_user: Currently authenticated user.\n    tenant: Optional tenant context.\n    db: Database session.\n\nReturns:\n    ProfileUpdateResponse with updated profile data.\n\nRaises:\n    HTTPException: If validation fails or access denied.",
        "operationId": "update_profile_api_v1_users_profile_patch",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ProfileUpdateRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ProfileUpdateResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["users"],
        "summary": "Delete Profile",
        "description": "Delete current user's profile.\n\nOnly the profile owner can delete their profile. This removes\nthe profile but keeps the user account (for audit purposes).\n\nArgs:\n    current_user: Currently authenticated user.\n    db: Database session.\n\nReturns:\n    ProfileDeleteResponse with success message.\n\nRaises:\n    HTTPException: If access denied.",
        "operationId": "delete_profile_api_v1_users_profile_delete",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ProfileDeleteResponse" }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/profile/{user_id}": {
      "get": {
        "tags": ["users"],
        "summary": "Get User Profile",
        "description": "Get user profile by ID with dynamic fields.\n\nAccess rules:\n- Users can access their own profile\n- Platform owners can access any profile\n- Company owners can access profiles of users in their company\n\nArgs:\n    user_id: ID of user whose profile to retrieve.\n    current_user: Currently authenticated user.\n    tenant: Optional tenant context.\n    db: Database session.\n\nReturns:\n    ProfileResponse with profile data and dynamic fields.\n\nRaises:\n    HTTPException: If user not found or access denied.",
        "operationId": "get_user_profile_api_v1_users_profile__user_id__get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "User Id" }
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ProfileResponse" } }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      },
      "patch": {
        "tags": ["users"],
        "summary": "Update User Profile",
        "description": "Update user profile by ID.\n\nAccess rules:\n- Users can update their own profile\n- Platform owners can update any profile\n- Company owners can update profiles of users in their company\n\nArgs:\n    user_id: ID of user whose profile to update.\n    payload: Profile update data (partial update).\n    current_user: Currently authenticated user.\n    tenant: Optional tenant context.\n    db: Database session.\n\nReturns:\n    ProfileUpdateResponse with updated profile data.\n\nRaises:\n    HTTPException: If user not found, validation fails, or access denied.",
        "operationId": "update_user_profile_api_v1_users_profile__user_id__patch",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "User Id" }
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ProfileUpdateRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ProfileUpdateResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/profile/{user_id}/ban": {
      "post": {
        "tags": ["users"],
        "summary": "Ban User",
        "description": "Ban a user.\n\nAccess rules:\n- Platform owners can ban any user\n- Company owners can ban users from their company\n- Cannot ban platform owners\n\nArgs:\n    user_id: ID of user to ban.\n    payload: Ban request with reason.\n    current_user: User performing the ban action.\n    tenant: Tenant context (required for company owner bans).\n    db: Database session.\n\nReturns:\n    ProfileBanResponse with success message.\n\nRaises:\n    HTTPException: If user not found, access denied, or cannot ban platform owner.",
        "operationId": "ban_user_api_v1_users_profile__user_id__ban_post",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "User Id" }
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/ProfileBanRequest" } }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ProfileBanResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/profile/fields/definitions": {
      "get": {
        "tags": ["users", "users:profile-fields"],
        "summary": "List Profile Field Definitions",
        "description": "List dynamic field definitions for user profiles.\n\nReturns definitions based on user permissions:\n- Platform owners: See all definitions (global, per_company, per_user)\n- Company owners: See global + company-scoped definitions\n- Regular users: See global + own per_user definitions",
        "operationId": "list_profile_field_definitions_api_v1_users_profile_fields_definitions_get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "scope",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                { "$ref": "#/components/schemas/DynamicFieldScopeEnum" },
                { "type": "null" }
              ],
              "description": "Filter by field scope (global, per_company, per_user)",
              "title": "Scope"
            },
            "description": "Filter by field scope (global, per_company, per_user)"
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DynamicFieldDefinitionListResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["users", "users:profile-fields"],
        "summary": "Create Profile Field Definition",
        "description": "Create a dynamic field definition for user profiles.\n\nAccess rules:\n- Platform owners: Can create global fields (scope=GLOBAL, company_id=None)\n- Company owners: Can create company-scoped fields (scope=PER_COMPANY, company_id=tenant.company_id)\n- Regular users: Can create self-managed fields (scope=PER_USER, owner_user_id=current_user.id)",
        "operationId": "create_profile_field_definition_api_v1_users_profile_fields_definitions_post",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/DynamicFieldDefinitionCreate" }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DynamicFieldDefinitionOut" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/profile/fields/definitions/{definition_id}": {
      "patch": {
        "tags": ["users", "users:profile-fields"],
        "summary": "Update Profile Field Definition",
        "description": "Update a dynamic field definition for user profiles.\n\nAccess rules:\n- Platform owners: Can update any definition\n- Company owners: Can update company-scoped definitions\n- Regular users: Can update own per_user definitions",
        "operationId": "update_profile_field_definition_api_v1_users_profile_fields_definitions__definition_id__patch",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "definition_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "Definition Id" }
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/DynamicFieldDefinitionUpdate" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DynamicFieldDefinitionOut" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["users", "users:profile-fields"],
        "summary": "Delete Profile Field Definition",
        "description": "Delete (deactivate) a dynamic field definition for user profiles.\n\nAccess rules:\n- Platform owners: Can delete any definition\n- Company owners: Can delete company-scoped definitions\n- Regular users: Can delete own per_user definitions",
        "operationId": "delete_profile_field_definition_api_v1_users_profile_fields_definitions__definition_id__delete",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "definition_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "Definition Id" }
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "responses": {
          "204": { "description": "Successful Response" },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/profile/{user_id}/fields": {
      "put": {
        "tags": ["users", "users:profile-fields"],
        "summary": "Set Profile Dynamic Fields",
        "description": "Set dynamic field values for a user profile.\n\nAccess rules:\n- Users can set their own field values (if editable_by_owner=True)\n- Platform owners can set any user's field values\n- Company owners can set field values for users in their company",
        "operationId": "set_profile_dynamic_fields_api_v1_users_profile__user_id__fields_put",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "User Id" }
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/DynamicFieldValuesUpdateRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/DynamicFieldValuesResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/crm/contacts": {
      "post": {
        "tags": ["crm:contacts"],
        "summary": "Create Contact",
        "description": "Create a new CRM contact within the current tenant/company.",
        "operationId": "create_contact_api_v1_crm_contacts_post",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/CrmContactCreate" } }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/CrmContactCreateResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      },
      "get": {
        "tags": ["crm:contacts"],
        "summary": "List Contacts",
        "description": "List contacts for the current tenant/company.\n\nSupports basic filtering by status and owner.",
        "operationId": "list_contacts_api_v1_crm_contacts_get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "minimum": 1, "default": 1, "title": "Page" }
          },
          {
            "name": "per_page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 20,
              "title": "Per Page"
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [{ "$ref": "#/components/schemas/ContactStatusEnum" }, { "type": "null" }],
              "title": "Status"
            }
          },
          {
            "name": "owner_user_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string", "format": "uuid" }, { "type": "null" }],
              "title": "Owner User Id"
            }
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/CrmContactListResponse" }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/api/v1/crm/contacts/{contact_id}": {
      "get": {
        "tags": ["crm:contacts"],
        "summary": "Get Contact",
        "description": "Get a single contact by id within the current tenant/company.",
        "operationId": "get_contact_api_v1_crm_contacts__contact_id__get",
        "security": [{ "OAuth2PasswordBearer": [] }],
        "parameters": [
          {
            "name": "contact_id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "Contact Id" }
          },
          {
            "name": "X-Company-Id",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "null" }],
              "title": "X-Company-Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/CrmContactOut" } }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HTTPValidationError" }
              }
            }
          }
        }
      }
    },
    "/": {
      "get": {
        "tags": ["system"],
        "summary": "Root",
        "description": "Root endpoint providing API information and links to documentation.",
        "operationId": "root__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": {} } }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AuthResponse": {
        "properties": { "user": { "$ref": "#/components/schemas/UserOut" } },
        "type": "object",
        "required": ["user"],
        "title": "AuthResponse",
        "description": "Authentication response with user data.\n\nTokens are stored in HTTPOnly cookies for security and are never\nincluded in the response body. This prevents XSS attacks and token\ntheft through JavaScript access."
      },
      "CompanyCreate": {
        "properties": {
          "official_name": {
            "type": "string",
            "maxLength": 255,
            "minLength": 1,
            "title": "Official Name"
          },
          "display_name": {
            "type": "string",
            "maxLength": 255,
            "minLength": 1,
            "title": "Display Name"
          },
          "country": { "type": "string", "maxLength": 2, "minLength": 2, "title": "Country" },
          "default_timezone": { "type": "string", "title": "Default Timezone", "default": "UTC" },
          "brand_color": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Brand Color"
          },
          "logo_url": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Logo Url" },
          "website_url": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Website Url"
          }
        },
        "type": "object",
        "required": ["official_name", "display_name", "country"],
        "title": "CompanyCreate"
      },
      "CompanyCreateResponse": {
        "properties": {
          "data": { "$ref": "#/components/schemas/CompanyOut" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "CompanyCreateResponse",
        "description": "Envelope for company creation."
      },
      "CompanyListResponse": {
        "properties": {
          "data": {
            "items": { "$ref": "#/components/schemas/CompanyOut" },
            "type": "array",
            "title": "Data"
          },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "CompanyListResponse",
        "description": "Envelope for listing companies for current user."
      },
      "CompanyOut": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "official_name": { "type": "string", "title": "Official Name" },
          "display_name": { "type": "string", "title": "Display Name" },
          "country": { "type": "string", "title": "Country" },
          "logo_url": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Logo Url" },
          "website_url": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Website Url"
          },
          "default_timezone": { "type": "string", "title": "Default Timezone" },
          "brand_color": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Brand Color"
          },
          "status": { "type": "string", "title": "Status" },
          "created_at": { "type": "string", "format": "date-time", "title": "Created At" }
        },
        "type": "object",
        "required": [
          "id",
          "official_name",
          "display_name",
          "country",
          "default_timezone",
          "status",
          "created_at"
        ],
        "title": "CompanyOut"
      },
      "ContactStatusEnum": {
        "type": "string",
        "enum": ["active", "inactive", "archived"],
        "title": "ContactStatusEnum",
        "description": "High-level lifecycle status of a contact.\n\nThis can be extended or replaced by dynamic fields later, but keeping\na small, well-defined set of statuses is often valuable for reporting\nand filtering."
      },
      "CrmContactCreate": {
        "properties": {
          "full_name": { "type": "string", "maxLength": 255, "minLength": 1, "title": "Full Name" },
          "primary_email": {
            "anyOf": [{ "type": "string", "format": "email" }, { "type": "null" }],
            "title": "Primary Email"
          },
          "primary_phone": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Primary Phone"
          },
          "source": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Source" }
        },
        "type": "object",
        "required": ["full_name"],
        "title": "CrmContactCreate"
      },
      "CrmContactCreateResponse": {
        "properties": {
          "data": { "$ref": "#/components/schemas/CrmContactOut" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "CrmContactCreateResponse",
        "description": "Envelope for a newly created contact."
      },
      "CrmContactListResponse": {
        "properties": {
          "data": {
            "items": { "$ref": "#/components/schemas/CrmContactOut" },
            "type": "array",
            "title": "Data"
          },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "CrmContactListResponse",
        "description": "Envelope for listing contacts."
      },
      "CrmContactOut": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "company_id": { "type": "string", "format": "uuid", "title": "Company Id" },
          "full_name": { "type": "string", "title": "Full Name" },
          "primary_email": {
            "anyOf": [{ "type": "string", "format": "email" }, { "type": "null" }],
            "title": "Primary Email"
          },
          "primary_phone": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Primary Phone"
          },
          "status": { "$ref": "#/components/schemas/ContactStatusEnum" },
          "source": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Source" },
          "owner_user_id": {
            "anyOf": [{ "type": "string", "format": "uuid" }, { "type": "null" }],
            "title": "Owner User Id"
          },
          "created_at": { "type": "string", "format": "date-time", "title": "Created At" }
        },
        "type": "object",
        "required": ["id", "company_id", "full_name", "status", "created_at"],
        "title": "CrmContactOut"
      },
      "DeviceListResponse": {
        "properties": {
          "data": {
            "items": { "$ref": "#/components/schemas/DeviceOut" },
            "type": "array",
            "title": "Data"
          },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "DeviceListResponse",
        "description": "Response envelope for device list."
      },
      "DeviceOut": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "device_name": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Device Name"
          },
          "device_type": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Device Type"
          },
          "os": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Os" },
          "browser": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Browser" },
          "ip_address": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Ip Address"
          },
          "status": { "type": "string", "title": "Status" },
          "is_trusted": { "type": "boolean", "title": "Is Trusted" },
          "last_seen_at": { "type": "string", "format": "date-time", "title": "Last Seen At" },
          "created_at": { "type": "string", "format": "date-time", "title": "Created At" },
          "revoked_at": {
            "anyOf": [{ "type": "string", "format": "date-time" }, { "type": "null" }],
            "title": "Revoked At"
          }
        },
        "type": "object",
        "required": ["id", "status", "is_trusted", "last_seen_at", "created_at"],
        "title": "DeviceOut",
        "description": "Device information for API responses."
      },
      "DeviceRevokeResponse": {
        "properties": {
          "data": { "additionalProperties": true, "type": "object", "title": "Data" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "DeviceRevokeResponse",
        "description": "Response envelope for device revocation."
      },
      "DynamicFieldDefinitionCreate": {
        "properties": {
          "entity_type": {
            "type": "string",
            "title": "Entity Type",
            "examples": ["company", "user_profile", "crm_contact"]
          },
          "key": { "type": "string", "maxLength": 64, "minLength": 1, "title": "Key" },
          "label": { "type": "string", "maxLength": 255, "minLength": 1, "title": "Label" },
          "description": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Description"
          },
          "field_type": { "$ref": "#/components/schemas/DynamicFieldTypeEnum" },
          "required": { "type": "boolean", "title": "Required", "default": false },
          "editable_by_owner": { "type": "boolean", "title": "Editable By Owner", "default": true },
          "editable_by_admin": { "type": "boolean", "title": "Editable By Admin", "default": true },
          "scope": { "$ref": "#/components/schemas/DynamicFieldScopeEnum", "default": "global" },
          "company_id": {
            "anyOf": [{ "type": "string", "format": "uuid" }, { "type": "null" }],
            "title": "Company Id"
          },
          "owner_user_id": {
            "anyOf": [{ "type": "string", "format": "uuid" }, { "type": "null" }],
            "title": "Owner User Id"
          },
          "visibility_rules": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Visibility Rules"
          },
          "validation_rules": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Validation Rules"
          },
          "default_value": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Default Value"
          }
        },
        "type": "object",
        "required": ["entity_type", "key", "label", "field_type"],
        "title": "DynamicFieldDefinitionCreate"
      },
      "DynamicFieldDefinitionListResponse": {
        "properties": {
          "data": {
            "items": { "$ref": "#/components/schemas/DynamicFieldDefinitionOut" },
            "type": "array",
            "title": "Data"
          },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "DynamicFieldDefinitionListResponse",
        "description": "Envelope for listing field definitions."
      },
      "DynamicFieldDefinitionOut": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "entity_type": { "type": "string", "title": "Entity Type" },
          "key": { "type": "string", "title": "Key" },
          "label": { "type": "string", "title": "Label" },
          "description": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Description"
          },
          "field_type": { "$ref": "#/components/schemas/DynamicFieldTypeEnum" },
          "required": { "type": "boolean", "title": "Required" },
          "editable_by_owner": { "type": "boolean", "title": "Editable By Owner" },
          "editable_by_admin": { "type": "boolean", "title": "Editable By Admin" },
          "scope": { "$ref": "#/components/schemas/DynamicFieldScopeEnum" },
          "company_id": {
            "anyOf": [{ "type": "string", "format": "uuid" }, { "type": "null" }],
            "title": "Company Id"
          },
          "owner_user_id": {
            "anyOf": [{ "type": "string", "format": "uuid" }, { "type": "null" }],
            "title": "Owner User Id"
          },
          "created_at": { "type": "string", "format": "date-time", "title": "Created At" },
          "updated_at": { "type": "string", "format": "date-time", "title": "Updated At" },
          "visibility_rules": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Visibility Rules"
          },
          "validation_rules": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Validation Rules"
          },
          "default_value": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Default Value"
          },
          "is_active": { "type": "boolean", "title": "Is Active" }
        },
        "type": "object",
        "required": [
          "id",
          "entity_type",
          "key",
          "label",
          "field_type",
          "required",
          "editable_by_owner",
          "editable_by_admin",
          "scope",
          "created_at",
          "updated_at",
          "is_active"
        ],
        "title": "DynamicFieldDefinitionOut"
      },
      "DynamicFieldDefinitionUpdate": {
        "properties": {
          "label": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Label" },
          "description": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Description"
          },
          "required": { "anyOf": [{ "type": "boolean" }, { "type": "null" }], "title": "Required" },
          "editable_by_owner": {
            "anyOf": [{ "type": "boolean" }, { "type": "null" }],
            "title": "Editable By Owner"
          },
          "editable_by_admin": {
            "anyOf": [{ "type": "boolean" }, { "type": "null" }],
            "title": "Editable By Admin"
          },
          "visibility_rules": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Visibility Rules"
          },
          "validation_rules": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Validation Rules"
          },
          "default_value": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Default Value"
          },
          "is_active": {
            "anyOf": [{ "type": "boolean" }, { "type": "null" }],
            "title": "Is Active"
          }
        },
        "type": "object",
        "title": "DynamicFieldDefinitionUpdate"
      },
      "DynamicFieldScopeEnum": {
        "type": "string",
        "enum": ["global", "per_company", "per_user"],
        "title": "DynamicFieldScopeEnum",
        "description": "Scope of field definition:\n\n- global: available to all tenants and users (platform-wide);\n- per_company: available only within a specific company/tenant;\n- per_user: available only to the owner user (for self-managed profile fields)."
      },
      "DynamicFieldTypeEnum": {
        "type": "string",
        "enum": [
          "string",
          "text",
          "number",
          "boolean",
          "date",
          "datetime",
          "select",
          "multiselect",
          "email",
          "phone"
        ],
        "title": "DynamicFieldTypeEnum"
      },
      "DynamicFieldValueItem": {
        "properties": {
          "definition_id": { "type": "string", "format": "uuid", "title": "Definition Id" },
          "value": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Value"
          }
        },
        "type": "object",
        "required": ["definition_id"],
        "title": "DynamicFieldValueItem"
      },
      "DynamicFieldValueOut": {
        "properties": {
          "definition_id": { "type": "string", "format": "uuid", "title": "Definition Id" },
          "entity_id": { "type": "string", "format": "uuid", "title": "Entity Id" },
          "value": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Value"
          }
        },
        "type": "object",
        "required": ["definition_id", "entity_id"],
        "title": "DynamicFieldValueOut"
      },
      "DynamicFieldValuesResponse": {
        "properties": {
          "data": {
            "items": { "$ref": "#/components/schemas/DynamicFieldValueOut" },
            "type": "array",
            "title": "Data"
          },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "DynamicFieldValuesResponse",
        "description": "Envelope for returning all values for an entity."
      },
      "DynamicFieldValuesUpdateRequest": {
        "properties": {
          "values": {
            "items": { "$ref": "#/components/schemas/DynamicFieldValueItem" },
            "type": "array",
            "title": "Values"
          }
        },
        "type": "object",
        "required": ["values"],
        "title": "DynamicFieldValuesUpdateRequest",
        "description": "Batch update of dynamic field values for a single entity instance."
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": { "$ref": "#/components/schemas/ValidationError" },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "HealthCheckResponse": {
        "properties": {
          "data": { "$ref": "#/components/schemas/HealthPayload" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "HealthCheckResponse",
        "description": "Specialized response for /health endpoint."
      },
      "HealthPayload": {
        "properties": { "status": { "type": "string", "title": "Status" } },
        "type": "object",
        "required": ["status"],
        "title": "HealthPayload"
      },
      "LoginRequest": {
        "properties": {
          "email": { "type": "string", "format": "email", "title": "Email" },
          "password": { "type": "string", "title": "Password" }
        },
        "type": "object",
        "required": ["email", "password"],
        "title": "LoginRequest"
      },
      "LoginResponse": {
        "properties": {
          "data": { "$ref": "#/components/schemas/AuthResponse" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "LoginResponse",
        "description": "Response envelope for successful login."
      },
      "LogoutResponse": {
        "properties": {
          "data": { "additionalProperties": true, "type": "object", "title": "Data" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "LogoutResponse",
        "description": "Response envelope for logout.\n\nThe data field contains a simple success message."
      },
      "ModuleListResponse": {
        "properties": {
          "data": {
            "items": { "$ref": "#/components/schemas/ModuleOut" },
            "type": "array",
            "title": "Data"
          },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "ModuleListResponse",
        "description": "Envelope for listing modules."
      },
      "ModuleOut": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "key": { "type": "string", "title": "Key" },
          "name": { "type": "string", "title": "Name" },
          "description": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Description"
          },
          "status": { "type": "string", "title": "Status" },
          "category": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Category" },
          "display_order": { "type": "integer", "title": "Display Order" },
          "metadata": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Metadata"
          },
          "created_at": { "type": "string", "format": "date-time", "title": "Created At" }
        },
        "type": "object",
        "required": ["id", "key", "name", "status", "display_order", "created_at"],
        "title": "ModuleOut"
      },
      "PermissionListResponse": {
        "properties": {
          "data": {
            "items": {
              "$ref": "#/components/schemas/app__modules__core__rbac__schemas__PermissionOut"
            },
            "type": "array",
            "title": "Data"
          },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "PermissionListResponse",
        "description": "Envelope for list of permissions."
      },
      "PlanListResponse": {
        "properties": {
          "data": {
            "items": { "$ref": "#/components/schemas/PlanOut" },
            "type": "array",
            "title": "Data"
          },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "PlanListResponse",
        "description": "Envelope for listing subscription plans."
      },
      "PlanOut": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "key": { "type": "string", "title": "Key" },
          "name": { "type": "string", "title": "Name" },
          "description": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Description"
          },
          "price_cents": { "type": "integer", "title": "Price Cents" },
          "currency": { "type": "string", "title": "Currency" },
          "billing_period": { "type": "string", "title": "Billing Period" },
          "trial_days": { "type": "integer", "title": "Trial Days" },
          "limits": {
            "anyOf": [{ "additionalProperties": true, "type": "object" }, { "type": "null" }],
            "title": "Limits"
          },
          "created_at": { "type": "string", "format": "date-time", "title": "Created At" }
        },
        "type": "object",
        "required": [
          "id",
          "key",
          "name",
          "price_cents",
          "currency",
          "billing_period",
          "trial_days",
          "created_at"
        ],
        "title": "PlanOut"
      },
      "ProfileBanRequest": {
        "properties": {
          "reason": {
            "type": "string",
            "maxLength": 1000,
            "minLength": 1,
            "title": "Reason",
            "description": "Reason for ban"
          }
        },
        "type": "object",
        "required": ["reason"],
        "title": "ProfileBanRequest",
        "description": "Request to ban a user.\n\nOnly platform owners and company owners can ban users.\nCompany owners can only ban users from their company."
      },
      "ProfileBanResponse": {
        "properties": {
          "data": { "additionalProperties": true, "type": "object", "title": "Data" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "title": "ProfileBanResponse",
        "description": "Response envelope for user ban."
      },
      "ProfileDeleteResponse": {
        "properties": {
          "data": { "additionalProperties": true, "type": "object", "title": "Data" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "title": "ProfileDeleteResponse",
        "description": "Response envelope for profile deletion."
      },
      "ProfileResponse": {
        "properties": {
          "data": { "$ref": "#/components/schemas/ProfileWithDynamicFields" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "ProfileResponse",
        "description": "Response envelope for profile data with dynamic fields."
      },
      "ProfileUpdateRequest": {
        "properties": {
          "first_name": {
            "anyOf": [{ "type": "string", "maxLength": 100 }, { "type": "null" }],
            "title": "First Name"
          },
          "last_name": {
            "anyOf": [{ "type": "string", "maxLength": 100 }, { "type": "null" }],
            "title": "Last Name"
          },
          "avatar_url": {
            "anyOf": [{ "type": "string", "maxLength": 512 }, { "type": "null" }],
            "title": "Avatar Url"
          },
          "job_title": {
            "anyOf": [{ "type": "string", "maxLength": 255 }, { "type": "null" }],
            "title": "Job Title"
          },
          "timezone": {
            "anyOf": [{ "type": "string", "maxLength": 64 }, { "type": "null" }],
            "title": "Timezone"
          },
          "signature_url": {
            "anyOf": [{ "type": "string", "maxLength": 512 }, { "type": "null" }],
            "title": "Signature Url"
          }
        },
        "type": "object",
        "title": "ProfileUpdateRequest",
        "description": "Request to update user profile information.\n\nOnly provided fields will be updated (partial update)."
      },
      "ProfileUpdateResponse": {
        "properties": {
          "data": { "$ref": "#/components/schemas/ProfileWithDynamicFields" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "ProfileUpdateResponse",
        "description": "Response envelope for profile update."
      },
      "ProfileWithDynamicFields": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "first_name": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "First Name"
          },
          "last_name": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Last Name"
          },
          "avatar_url": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Avatar Url"
          },
          "job_title": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Job Title"
          },
          "timezone": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Timezone" },
          "signature_url": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Signature Url"
          },
          "created_at": { "type": "string", "format": "date-time", "title": "Created At" },
          "updated_at": { "type": "string", "format": "date-time", "title": "Updated At" },
          "dynamic_fields": {
            "additionalProperties": true,
            "type": "object",
            "title": "Dynamic Fields",
            "description": "Dynamic field values keyed by field definition key"
          }
        },
        "type": "object",
        "required": ["id", "created_at", "updated_at"],
        "title": "ProfileWithDynamicFields",
        "description": "User profile with dynamic fields included."
      },
      "RefreshTokenResponse": {
        "properties": {
          "data": { "$ref": "#/components/schemas/AuthResponse" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "RefreshTokenResponse",
        "description": "Response envelope for token refresh.\n\nReturns user data. New tokens are set in HTTPOnly cookies and are\nnever included in the response body for security."
      },
      "RegisterRequest": {
        "properties": {
          "email": { "type": "string", "format": "email", "title": "Email" },
          "password": { "type": "string", "maxLength": 128, "minLength": 8, "title": "Password" },
          "locale": { "type": "string", "title": "Locale", "default": "en" },
          "first_name": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "First Name"
          },
          "last_name": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Last Name" }
        },
        "type": "object",
        "required": ["email", "password"],
        "title": "RegisterRequest"
      },
      "RegisterResponse": {
        "properties": {
          "data": { "$ref": "#/components/schemas/AuthResponse" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "RegisterResponse",
        "description": "Response envelope for successful registration."
      },
      "RequestPasswordResetRequest": {
        "properties": { "email": { "type": "string", "format": "email", "title": "Email" } },
        "type": "object",
        "required": ["email"],
        "title": "RequestPasswordResetRequest",
        "description": "Request to send password reset email."
      },
      "RequestPasswordResetResponse": {
        "properties": {
          "data": { "additionalProperties": true, "type": "object", "title": "Data" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "RequestPasswordResetResponse",
        "description": "Response envelope for password reset request.\n\nAlways returns success (to prevent email enumeration)."
      },
      "ResendVerificationEmailResponse": {
        "properties": {
          "data": { "additionalProperties": true, "type": "object", "title": "Data" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "ResendVerificationEmailResponse",
        "description": "Response envelope for resending verification email.\n\nThe data field contains a simple success message."
      },
      "ResetPasswordRequest": {
        "properties": {
          "token": {
            "type": "string",
            "title": "Token",
            "description": "Password reset token from email link"
          },
          "new_password": {
            "type": "string",
            "maxLength": 128,
            "minLength": 8,
            "title": "New Password",
            "description": "New password"
          }
        },
        "type": "object",
        "required": ["token", "new_password"],
        "title": "ResetPasswordRequest",
        "description": "Request to reset password using a token."
      },
      "ResetPasswordResponse": {
        "properties": {
          "data": { "additionalProperties": true, "type": "object", "title": "Data" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "ResetPasswordResponse",
        "description": "Response envelope for password reset.\n\nThe data field contains a simple success message."
      },
      "RoleListResponse": {
        "properties": {
          "data": {
            "items": { "$ref": "#/components/schemas/app__modules__core__rbac__schemas__RoleOut" },
            "type": "array",
            "title": "Data"
          },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "RoleListResponse",
        "description": "Envelope for list of roles."
      },
      "StandardMeta": {
        "properties": {
          "page": { "anyOf": [{ "type": "integer" }, { "type": "null" }], "title": "Page" },
          "per_page": { "anyOf": [{ "type": "integer" }, { "type": "null" }], "title": "Per Page" },
          "total": { "anyOf": [{ "type": "integer" }, { "type": "null" }], "title": "Total" }
        },
        "type": "object",
        "title": "StandardMeta",
        "description": "Standard meta object included in all successful responses."
      },
      "UserListItemFull": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "email": { "type": "string", "title": "Email" },
          "locale": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Locale" },
          "status": { "type": "string", "title": "Status" },
          "email_verified": { "type": "boolean", "title": "Email Verified" },
          "created_at": { "type": "string", "format": "date-time", "title": "Created At" },
          "profile": {
            "anyOf": [{ "$ref": "#/components/schemas/UserProfileOut" }, { "type": "null" }]
          },
          "banned_at": {
            "anyOf": [{ "type": "string", "format": "date-time" }, { "type": "null" }],
            "title": "Banned At"
          },
          "banned_by": {
            "anyOf": [{ "type": "string", "format": "uuid" }, { "type": "null" }],
            "title": "Banned By"
          },
          "ban_reason": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Ban Reason"
          }
        },
        "type": "object",
        "required": ["id", "email", "status", "email_verified", "created_at"],
        "title": "UserListItemFull",
        "description": "User information for list views.\n\nThis schema provides user data with optional fields for GDPR compliance:\n- Company owners: All fields populated (full information)\n- Platform owners: Sensitive fields (locale, ban info) are None (minimal information)\n\nThis approach ensures GDPR compliance while maintaining a single response schema."
      },
      "UserListResponse": {
        "properties": {
          "data": {
            "items": { "$ref": "#/components/schemas/UserListItemFull" },
            "type": "array",
            "title": "Data"
          },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "UserListResponse",
        "description": "Response envelope for user list.\n\nNote: The actual data returned depends on user permissions:\n- Company owners: Full information (all fields populated)\n- Platform owners: Minimal information (locale, banned_at, banned_by, ban_reason are None)"
      },
      "UserOut": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "email": { "type": "string", "format": "email", "title": "Email" },
          "locale": { "type": "string", "title": "Locale" },
          "status": { "type": "string", "title": "Status" },
          "email_verified": { "type": "boolean", "title": "Email Verified" },
          "created_at": { "type": "string", "format": "date-time", "title": "Created At" },
          "profile": {
            "anyOf": [{ "$ref": "#/components/schemas/UserProfileOut" }, { "type": "null" }]
          },
          "permissions": {
            "items": {
              "$ref": "#/components/schemas/app__modules__core__auth__schemas__PermissionOut"
            },
            "type": "array",
            "title": "Permissions",
            "description": "List of permissions granted to the user via platform roles"
          },
          "roles": {
            "items": { "$ref": "#/components/schemas/app__modules__core__auth__schemas__RoleOut" },
            "type": "array",
            "title": "Roles",
            "description": "List of platform roles assigned to the user"
          }
        },
        "type": "object",
        "required": ["id", "email", "locale", "status", "email_verified", "created_at"],
        "title": "UserOut"
      },
      "UserProfileOut": {
        "properties": {
          "first_name": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "First Name"
          },
          "last_name": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Last Name"
          },
          "avatar_url": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Avatar Url"
          },
          "job_title": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Job Title"
          },
          "timezone": { "anyOf": [{ "type": "string" }, { "type": "null" }], "title": "Timezone" },
          "signature_url": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Signature Url"
          }
        },
        "type": "object",
        "title": "UserProfileOut"
      },
      "UserResponse": {
        "properties": {
          "data": { "$ref": "#/components/schemas/UserWithFullInfo" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "UserResponse",
        "description": "Response envelope for complete user information."
      },
      "UserWithFullInfo": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "email": { "type": "string", "title": "Email" },
          "locale": { "type": "string", "title": "Locale" },
          "status": { "type": "string", "title": "Status" },
          "email_verified": { "type": "boolean", "title": "Email Verified" },
          "created_at": { "type": "string", "format": "date-time", "title": "Created At" },
          "profile": {
            "anyOf": [{ "$ref": "#/components/schemas/UserProfileOut" }, { "type": "null" }]
          },
          "permissions": {
            "items": {
              "$ref": "#/components/schemas/app__modules__core__auth__schemas__PermissionOut"
            },
            "type": "array",
            "title": "Permissions",
            "description": "List of permissions granted to the user via platform roles"
          },
          "roles": {
            "items": { "$ref": "#/components/schemas/app__modules__core__auth__schemas__RoleOut" },
            "type": "array",
            "title": "Roles",
            "description": "List of platform roles assigned to the user"
          },
          "dynamic_fields": {
            "additionalProperties": true,
            "type": "object",
            "title": "Dynamic Fields",
            "description": "Dynamic field values keyed by field definition key"
          },
          "banned_at": {
            "anyOf": [{ "type": "string", "format": "date-time" }, { "type": "null" }],
            "title": "Banned At"
          },
          "banned_by": {
            "anyOf": [{ "type": "string", "format": "uuid" }, { "type": "null" }],
            "title": "Banned By"
          },
          "ban_reason": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Ban Reason"
          }
        },
        "type": "object",
        "required": ["id", "email", "locale", "status", "email_verified", "created_at"],
        "title": "UserWithFullInfo",
        "description": "Complete user information including profile, permissions, roles, and dynamic fields.\n\nThis schema is used for endpoints that return comprehensive user data,\nsimilar to /auth/me but with additional dynamic fields support."
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": { "anyOf": [{ "type": "string" }, { "type": "integer" }] },
            "type": "array",
            "title": "Location"
          },
          "msg": { "type": "string", "title": "Message" },
          "type": { "type": "string", "title": "Error Type" }
        },
        "type": "object",
        "required": ["loc", "msg", "type"],
        "title": "ValidationError"
      },
      "VerifyEmailRequest": {
        "properties": {
          "token": {
            "type": "string",
            "title": "Token",
            "description": "Email verification token from email link"
          }
        },
        "type": "object",
        "required": ["token"],
        "title": "VerifyEmailRequest",
        "description": "Request to verify email address using a token."
      },
      "VerifyEmailResponse": {
        "properties": {
          "data": { "additionalProperties": true, "type": "object", "title": "Data" },
          "meta": { "$ref": "#/components/schemas/StandardMeta" }
        },
        "type": "object",
        "required": ["data"],
        "title": "VerifyEmailResponse",
        "description": "Response envelope for email verification.\n\nThe data field contains a simple success message."
      },
      "app__modules__core__auth__schemas__PermissionOut": {
        "properties": {
          "key": { "type": "string", "title": "Key" },
          "scope": { "type": "string", "title": "Scope" },
          "module_key": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Module Key"
          },
          "description": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Description"
          }
        },
        "type": "object",
        "required": ["key", "scope"],
        "title": "PermissionOut",
        "description": "Permission information for frontend authorization checks."
      },
      "app__modules__core__auth__schemas__RoleOut": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "scope": { "type": "string", "title": "Scope" },
          "key": { "type": "string", "title": "Key" },
          "name": { "type": "string", "title": "Name" },
          "description": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Description"
          },
          "is_system": { "type": "boolean", "title": "Is System" },
          "is_owner": { "type": "boolean", "title": "Is Owner" }
        },
        "type": "object",
        "required": ["id", "scope", "key", "name", "is_system", "is_owner"],
        "title": "RoleOut",
        "description": "Role information for frontend authorization checks.\n\nThis represents a platform role assigned to the user.\nCompany-scoped roles are not included here as they require tenant context."
      },
      "app__modules__core__rbac__schemas__PermissionOut": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "key": { "type": "string", "title": "Key" },
          "scope": { "type": "string", "title": "Scope" },
          "module_key": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Module Key"
          },
          "description": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Description"
          }
        },
        "type": "object",
        "required": ["id", "key", "scope"],
        "title": "PermissionOut"
      },
      "app__modules__core__rbac__schemas__RoleOut": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "scope": { "type": "string", "title": "Scope" },
          "key": { "type": "string", "title": "Key" },
          "name": { "type": "string", "title": "Name" },
          "description": {
            "anyOf": [{ "type": "string" }, { "type": "null" }],
            "title": "Description"
          },
          "company_id": {
            "anyOf": [{ "type": "string", "format": "uuid" }, { "type": "null" }],
            "title": "Company Id"
          },
          "is_system": { "type": "boolean", "title": "Is System" },
          "is_owner": { "type": "boolean", "title": "Is Owner" }
        },
        "type": "object",
        "required": ["id", "scope", "key", "name", "is_system", "is_owner"],
        "title": "RoleOut"
      }
    },
    "securitySchemes": {
      "OAuth2PasswordBearer": {
        "type": "oauth2",
        "flows": { "password": { "scopes": {}, "tokenUrl": "/api/v1/auth/login" } }
      }
    }
  }
}
